<% content_for :title, "Editing #{@item.name_was || "Item"}" %>

<div class="max-w-2xl mx-auto p-6">
  <%# Navigation Breadcrumbs - Safe navigation with try/presence %>
  <nav class="flex items-center space-x-4 mb-6 text-sm font-medium">
    <% if @item.category.present? %>
      <%= link_to category_path(@item.category), class: "text-gray-500 hover:text-indigo-600 transition-colors flex items-center" do %>
        <svg
          class="mr-1.5 h-4 w-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 19l-7-7m0 0l7-7m-7 7h18"
          />
        </svg>
        <%= @item.category.name %>
      <% end %>
      <span class="text-gray-300">/</span>
    <% end %>

    <%= link_to "View Item",
    item_path(@item),
    class: "text-gray-500 hover:text-indigo-600 transition-colors" %>
  </nav>

  <%# Page Header %>
  <header class="mb-8 border-b border-gray-100 pb-6">
    <div class="flex items-center gap-3">
      <div class="p-2 bg-indigo-50 rounded-lg">
        <svg
          class="w-6 h-6 text-indigo-600"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
          />
        </svg>
      </div>
      <div>
        <h1 class="text-3xl font-extrabold text-gray-900 tracking-tight">Edit Item</h1>
        <p class="text-sm text-gray-500 mt-1">
          Update details for
          <span class="font-semibold text-gray-700"><%= @item.name_was %></span>
        </p>
      </div>
    </div>
  </header>

  <%# Form Partial %>
  <div class="mt-4">
    <%= render "form", item: @item %>
  </div>

  <%# Footer Link - Fallback to categories index if no category is present %>
  <div class="mt-8 text-center">
    <% back_path = @item.category ? category_path(@item.category) : categories_path %>
    <%= link_to "Cancel and go back",
    back_path,
    class: "text-sm text-gray-400 hover:text-gray-600 transition-colors" %>
  </div>
</div>
